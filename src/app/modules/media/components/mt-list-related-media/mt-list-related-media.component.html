<mat-card class="composite compact">
  <div class="composite-header">
    <div class="header">
      <h2 class="text-100 bold no-margin flex-1">
        {{ mediaType.toLowerCase() + '.dashboard.relatedMedia' | translate }}
      </h2>

      <mt-header-picker
        iconName="star-half-stroke"
        placeholder="{{ 'media.scoreValues.undefined' | translate }}"
        [matTooltip]="'media.score' | translate"
        [options]="mediaScores"
        [value]="selectedScore"
        [getOptionLiteral]="getScoreLiteral"
        [onChange]="setSelectedScore"
      ></mt-header-picker>

      @if (isAnime(mediaType)) {
        <mt-header-picker
          iconName="film"
          placeholder="{{ 'media.formatValues.undefined' | translate }}"
          [matTooltip]="'media.format' | translate"
          [multiple]="true"
          [options]="mediaFormats"
          [truncate]="true"
          [value]="selectedFormats"
          [getOptionLiteral]="getFormatLiteral"
          [onChange]="setSelectedFormats"
        ></mt-header-picker>
      }

      <mt-header-picker
        iconName="sort"
        [matTooltip]="'generic.sort' | translate"
        [options]="mediaSorts"
        [value]="selectedSort"
        [getOptionLiteral]="getSortLiteral"
        [onChange]="setSelectedSort"
      ></mt-header-picker>
    </div>
  </div>

  <div class="content no-padding-bottom">
    <div #content>
      @if (searching || !started) {
        <div class="placeholder" [ngClass]="{ 'with-pagination': pagination }">
          @if (searching) {
            <mat-spinner mode="indeterminate"></mat-spinner>
          }
          @if (!started) {
            <button
              mat-raised-button
              type="button"
              color="primary"
              (click)="enable()"
            >
              <fa-icon name="search baseline"></fa-icon>
              <span>{{ 'media.search.submit' | translate }}</span>
            </button>
          }
        </div>
      }

      @if (!searching && started && mediaList?.length) {
        <div class="media-cover-grid">
          @for (media of mediaList; track media) {
            <mt-media-cover [media]="media"></mt-media-cover>
          }
        </div>
      }

      @if (mediaList?.length) {
        <div class="padding-vertical-3xs">
          <mt-pagination
            class="basic"
            [hidePageSize]="true"
            [lazy]="true"
            [pagination]="pagination"
            (changePage)="changePage($event)"
          >
          </mt-pagination>
        </div>
      }

      @if (pagination && !pagination.total) {
        <mt-alert type="info">
          {{ 'generic.noResults' | translate }}
        </mt-alert>
      }

      @if (started && error) {
        <mt-alert type="error">
          {{ error }}
        </mt-alert>
      }
    </div>
  </div>
</mat-card>
