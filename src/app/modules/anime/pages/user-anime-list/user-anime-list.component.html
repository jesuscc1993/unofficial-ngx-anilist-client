<div class="narrow-page">
  <mat-card *ngIf="!user" class="alert warning">
    <p class="bold">
      <fa-icon name="exclamation-circle" class="margin-right-2xs"></fa-icon>
      {{ 'user.notLoggedIn' | translate }}
    </p>
  </mat-card>

  <mat-spinner
    *ngIf="user && !ready"
    class="full-page"
    mode="indeterminate"
  ></mat-spinner>

  <div *ngIf="ready">
    <div *ngIf="statuses?.length">
      <mat-card class="table-filter">
        <mat-form-field class="full-width">
          <input
            matInput
            placeholder="{{ 'media.search.filters.byTitle' | translate }}"
            (keyup)="applyFilter($event.target.value)"
          />
        </mat-form-field>
      </mat-card>

      <mat-card class="margin-top-sm">
        <p class="text-115 bold">
          {{ 'media.userList.show' | translate }} /
          {{ 'media.userList.goTo' | translate }}
        </p>

        <div class="statuses-wrapper">
          <span *ngFor="let status of statuses" class="status-wrapper">
            <div *ngIf="hasDataOfStatus(status.value)">
              <mat-checkbox [(ngModel)]="status.shown">{{
                'anime.statusValues.' + status.value | translate
              }}</mat-checkbox>

              <a class="go-to-link" (click)="scrollToStatus(status.value)">
                <fa-icon
                  class="vertically-centered margin-left-3xs"
                  name="arrow-down"
                ></fa-icon>
              </a>
            </div>
          </span>
        </div>
      </mat-card>

      <div *ngFor="let status of statuses">
        <div
          *ngIf="status.shown && hasDataOfStatus(status.value)"
          class="status-table-wrapper"
          id="{{ status.value }}"
        >
          <mt-user-media-list-table
            [favouriteIDs]="favouriteIDs"
            [filter]="filter"
            [tableData]="listEntriesByStatus[status.value]"
            [tableStatus]="status.value"
            mediaType="ANIME"
          >
          </mt-user-media-list-table>
        </div>
      </div>

      <div class="text-center margin-top-xs">
        <button
          mat-raised-button
          type="button"
          color="accent"
          (click)="exportList($event)"
        >
          <fa-icon name="file-download"></fa-icon>
          <span>{{ 'media.userList.exportList' | translate }}</span>
        </button>
      </div>

      <mt-genres-overview [genreStatsList]="user.stats.favouredGenresOverview">
      </mt-genres-overview>
    </div>

    <mat-card *ngIf="ready && !error && !statuses?.length">
      <p class="bold">
        <fa-icon name="exclamation-circle" class="margin-right-2xs"></fa-icon>
        {{ 'media.userList.noEntries' | translate }}
      </p>
    </mat-card>
  </div>

  <mat-card *ngIf="error" class="error">
    <p class="bold">
      <fa-icon name="exclamation-circle" class="margin-right-2xs"></fa-icon>
      {{ error }}
    </p>
  </mat-card>
</div>
